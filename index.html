document.addEventListener("DOMContentLoaded", () => {
    const screen = document.getElementById("screen");
    let currentInput = "0";
    let operator = null;
    let firstOperand = null;

    // ğŸŒ™ A í˜ì´ì§€ì—ì„œ ì €ì¥í•œ ë‹¤í¬ ëª¨ë“œ ì„¤ì • ê°€ì ¸ì˜¤ê¸°
    let darkMode = localStorage.getItem("darkMode");
    if (darkMode === "enabled") {
        document.body.classList.add("dark-mode");
    }

    // ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
    document.querySelectorAll(".btn").forEach(button => {
        button.addEventListener("click", () => {
            const value = button.dataset.value;

            if (!isNaN(value) || value === ".") {
                handleNumber(value);
            } else if (value === "AC") {
                resetCalculator();
            } else if (value === "+/-") {
                toggleSign();
            } else if (value === "%") {
                applyPercentage();
            } else if (value === "=") {
                calculateResult();
            } else {
                handleOperator(value);
            }
            updateScreen();
        });
    });

    function handleNumber(value) {
        if (currentInput === "0" && value !== ".") {
            currentInput = value; // ì²« ë²ˆì§¸ ìˆ«ì ì…ë ¥ì‹œ "0" ëŒ€ì‹  ì…ë ¥ëœ ê°’ìœ¼ë¡œ ë³€ê²½
        } else {
            currentInput += value; // ê·¸ ì™¸ ìˆ«ìëŠ” ê¸°ì¡´ ì…ë ¥ ë’¤ì— ì´ì–´ ë¶™ì´ê¸°
        }
    }

    function resetCalculator() {
        currentInput = "0";
        operator = null;
        firstOperand = null;
    }

    function toggleSign() {
        currentInput = (parseFloat(currentInput) * -1).toString();
    }

    function applyPercentage() {
        currentInput = (parseFloat(currentInput) / 100).toString();
    }

    function calculateResult() {
        if (firstOperand !== null && operator !== null) {
            switch (operator) {
                case "+":
                    currentInput = (firstOperand + parseFloat(currentInput)).toString();
                    break;
                case "-":
                    currentInput = (firstOperand - parseFloat(currentInput)).toString();
                    break;
                case "*":
                    currentInput = (firstOperand * parseFloat(currentInput)).toString();
                    break;
                case "/":
                    currentInput = (firstOperand / parseFloat(currentInput)).toString();
                    break;
            }
            operator = null;
            firstOperand = null;
        }
    }

    function handleOperator(value) {
        if (firstOperand === null) {
            firstOperand = parseFloat(currentInput);
        } else if (operator !== null) {
            calculateResult();
        }
        operator = value;
        currentInput = "0";
    }

    function updateScreen() {
        screen.textContent = currentInput;
    }
});
